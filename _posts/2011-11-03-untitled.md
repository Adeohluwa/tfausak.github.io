---
layout: post
title: untitled
published: false
---

Yesterday, [I introduced a new feature][1] I worked on this week:
[Famigo Applists][2]. Today, I'll talk about developing that feature.

## Front End

Easily finding and adding apps is integral to applists. It needed
to be as simple and easy as possible. Sure, you could hunt for each
app's URL in the Android Market and paste it into a text box, but
that wouldn't be any fun. I decided to leverage our database of
over 30,000 apps to provide an autocomplete dropdown.

We already use [jQuery][3] as our JavaScript library of choice, so
I looked into [jQuery UI][3] to handle the user-interface stuff.
Fortunately, they have [an autocomplete widget][5] that does
everything I need. I'm using it with a remote data source (more on
that later) and a customized list of suggestions.

I only need two functions to customize the autocomplete widget: one
that gets called to create the items in the dropdown list, and
another that gets called when an item is selected.

For the first, I wanted users to easily pick out the right app.
(This is tough without popularity information. [Searching for "angry
birds"][6] is a mess.) To do this, I included several bits of
information: the app name, the developer, the platform (Android or
iOS), and the icon.

{% highlight %}
function autocomplete_render (ul, item) {
    return $('<li/>')
        .data('item.autocomplete', item)
        .append($('a/>')
            .append($('<img/>')
                .addClass('platform')
                .attr('src', '...'))
            .append($('<img/>')
                .addClass('icon')
                .attr('src', '...'))
            .append($('<span/>')
                .addClass('name')
                .html('...'))
            .append($('<span/>')
                .addClass('developer')
                .html('...')))
        .appendTo(ul);
};
{% endhighlight %}

![Screenshot of the autocomplete dropdown][7]

For the second, I already had a template to follow. I used the same
formatting as our [shared sandbox page][8] and just translated it
into jQuery. Each list item has the same information as the dropdown,
but it's styled differently.

We also need to do a couple other small things in this function.
One, we need to add the app to the top of the applist. We do this
using jQuery's `slideDown` function. Also, we have to empty the
autocomplete box and re-focus on it so the user can add another
app.

{% highlight js %}
function autocomplete_select (event, ui) {
    $('<li/>')
        .append($('<img/>')
            .addClass('platform')
            .attr('src', '...'))
        .append($('<img/>')
            .addClass('icon')
            .attr('src', '...'))
        .append($('<div/>')
            .addClass('name')
            .html('...'))
        .append($('<div/>')
            .addClass('developer')
            .html('...'))
        .hide()
        .prependTo('#list')
        .slideDown();
    $(this).focus().val('');
    return false;
}
{% endhighlight %}

![Screenshot of an app in the applist][9]

All that's left is to enable the autocompletion widget and set it
up to use our custom functions.

{% highlight js %}
$('#autocomplete').autocomplete({
    select: autocomplete_select,
    source: '/applist/autocomplete/'
}).data('autocomplete')._renderItem = autocomplete_render;
{% endhighlight %}

[1]: /2011/11/02/applists-playlists-for-your-apps/
[2]: http://www.famigo.com/applist/
[3]: http://jquery.com/
[4]: http://jqueryui.com/
[5]: http://jqueryui.com/demos/autocomplete/
[6]: https://market.android.com/search?q=angry+birds
[7]: /static/images/2011-11-02-figure-1.png
[8]: http://www.famigo.com/family/TkhYNRMsAG1JYT0fCBMNASkZZW0CbCxa/sandbox/
[9]: /static/images/2011-11-02-figure-2.png
